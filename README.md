# NgImageViewer
## v.0.0.2

[modern версия].
[ ![old-school](https://github.com/user-attachments/assets/709767e0-14d0-46da-9e4a-cc4463a84ba0) Без хуков см. ветку https://github.com/DjonnyX/dv-tst/tree/without-hooks]

__ВАЖНО!__ _В ветке `without-hooks` контент изображений не санитизирован! Возможна `XSS` уязвимость через `textarea`._

Demo: https://dv-tst.eugene-grebennikov.pro

![doc-viewer-preview](https://github.com/user-attachments/assets/25c1ba49-638c-4231-8e12-5a277ea2d477)


ЦЕЛЬЮ ВЫПОЛНЕНИЯ ЗАДАНИЯ, ЯВЛЯЕТСЯ РЕЗУЛЬТАТ РАБОТЫ ВЫПОЛНЕНИЯ ПРОГРАММЫ, ВЫПОЛНЕННОЙ В ХОДЕ ЭКСТРИМАЛЬНОГО ПРОГРАММИРОВАНИЯ!
НЕ ПЫТАЙТЕСЬ ПОВТОРИТЬ ЭТО ДОМА:)

### Преимущества:
- `FSD` архитектура. Приложение построено на `FSD` архитектуре, дает преимущество стандартизации в командной разработке.
- Гибридный рендеринг вьюпорта страниц (`canvas` + стандартный `DOM`). Даёт прирост в скорости рендеринга. Минусы - более сложная реализация.
- Упор на оптимизацию производительности. При большом количестве страниц, приложение останется работать со стабильно высокой скоростью отображения и не будет потреблять лишних ресурсов памяти.
- Легковесный клиент.
- Не используются сторонние библиотеки и решения `[кроме экосистемы Angular 19]`

### Недостатки:
- Реализация `Infinity-скролла` более сложная в данном подходе, чем стандартными средствами `DOM`. Поэтому в рамках тестового задания применил подход постраничного отображения.

### Известные проблемы:
- Скроллинг вьюпорта гибридный, реализация сложная. Есть недостаток отсутствия "обратного позиционирования" `scrollbar'ов`, поэтому при инициализации у `thumb'ов` немного "не своя позиция" на треке. Это решается созданием новых и доработками существующих методов `scrollbar'ов`.
- Перемещение анотации не сопровождается анимацией передвижения. Необходима доработка обработчиков `cdkDrag`.
- При переключении режима контента анотации не выводится диалог о подтверждении приминения действия. В связи с этим контент `[загруженного изображения]` не ресетится и в поле текстовых заметок отображается `base64` строка.
- Ресайз вьюпорта. При ресайзе окна браузера, временами пропадает контент из поля видимости вьюпорта. Возможно некорректный перерасчет позиций `px` и `py` на `canvas`.

### Известные улучшения:
- Архитектура `FSD`. Для `@entities/anotation` "проброшены" сервисы из `@features/anotations`. По-хорошему так быть не должно `[разрабатывал, как говорится "на скорую руку"]`, нужно вынести врапперы в отдельные `feature` компоненты.
- Редактирование анотаций. При редактировании желательно выставлять наибольший `z-index` у редактируемой анотации, чтобы отрабатывал `top most` и редактируемая анотация не перекрывалась более "новой" по индексу.
- Удобство. Для повышения качества `UX`, желательно реализовать события скролла области вьюпорта колесом мыши и поддержать использование тачпада при навигации вьюпорта. В добавок поддержку навигации вьюпорта мобильными устройствами `[Корректная обработка touch-событий]`.
- Безопасность. Для получения манифеста желательно использовать схему валидации для `DTO`.
- Рефакторинг. Для улучшенного переиспользования кода, можно вынести некоторый функционал в отдельные дерективы, такие как `autocomplite`, `clickOutside` и т.п.
- Загрузка изображений. Более корректно было бы сделать отдельный компонент `FilePicker`.
- Загрузка изображений. Для изображений анотаций желательно сделать компонент `DownSampler`, который будет ресайзить изображение до нужного разрешения. Чтобы предотвратить добавление `hires` ресурсов и оптимизировать производительность. 
- Стили. Вынести стили в `shared` модуль для переиспользуемых элементов `UI`. Добавить миксины на повторяющиеся блоки `scss`.



_P.S.: Основным упором было продемонстрировать концепцию гибридного рендеринга вьюпорта. Известные проблемы и возможные улучшения оставил, для факультативного размышления:) `[не влияет на демонстрацию основного флоу задания]`._

## Разработка 

Проект сгенерирован с использованием [Angular CLI](https://github.com/angular/angular-cli) version 19.2.3.

- Режим мок-данных доступен в режиме разработке^
```bash
ng serve
```

- Для `prod` сборки приложения на моках нужно в `environment.ts` выставить следущее:

```ts
export const environment = {
    production: true,
    useMock: true, // Переключает имплементацию сервиса получения данных на моки
};
```

## Development сервер

Для запуска локального dev-сервера, запустить:

```bash
ng serve
```

Сервер запустится, перейдите по адресу `http://localhost:4200/`. Приложение будет автоматически перезапускаться при внесении некоторых изменений в файлы и ресурсы проекта.

## Кодогенерация

Angular CLI включает мощные средства кодогенерации. Для генерации нового компонента, запустите:

```bash
ng generate component component-name
```

Для полного списка доступных схем (таких как `components`, `directives`, или `pipes`), запустите:

```bash
ng generate --help
```

## Сборка

Для сборки проекта, запустите:

```bash
ng build
```

Это скомпилирует проект и сложет файлы собранного проекта в директорию `dist/`. По-умолчанию `production` сборка оптимизирует производительность и скорость приложения.

e2e тесты по-умолчанию отключены.

## Дополнительные ресурсы

For more information on using the Angular CLI, including detailed command references, visit the [Angular CLI Overview and Command Reference](https://angular.dev/tools/cli) page.
